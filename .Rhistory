provincias[, "VS"]
View(provincias)
provincias[, "VS"]
provincias$VS
provincias$VS[provincias$cluster == 3]
provincias$VS[provincias$cluster == 3, ]
provincias$VS[provincias$cluster == 3]
provincias$VS[provincias$cluster == 3]
data.frame(provincias$VS[provincias$cluster == 3])
data.frame(provincias$VS[provincias$cluster == 3], row.names = rownames(provincias))
rownames(provincias)
data.frame(provincias$VS[provincias$cluster == 3], row.names = rownames(provincias)[provincias$cluster == 3])
data.frame("VS "= provincias$VS[provincias$cluster == 3], row.names = rownames(provincias)[provincias$cluster == 3])
data.frame("VS"= provincias$VS[provincias$cluster == 3], row.names = rownames(provincias)[provincias$cluster == 3])
ggarrange(provincias %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot(), nrow = 2, ncol = 3, common.legend = TRUE)
ggarrange(provincias %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(outlier.fill = rownames),
provincias %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot(), nrow = 2, ncol = 3, common.legend = TRUE)
ggarrange(provincias %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(outlier.fill = "rownames"),
provincias %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot(), nrow = 2, ncol = 3, common.legend = TRUE)
ggarrange(provincias %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(outlier.stroke = "s"),
provincias %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot(), nrow = 2, ncol = 3, common.legend = TRUE)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),                                                                                                                     vjust = -0.5),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
is_outlier <- function(x) {
print(x %in% boxplot(x, plot = FALSE)$out)
return(x < quantile(x, 0.25) - (1.5 * IQR(x)) | x > quantile(x, 0.75) + 1.5 * IQR(x))
}
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),                                                                                                                     vjust = -0.5),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
is_outlier <- function(x) {
print(x %in% boxplot(x, plot = FALSE)$out)
return(x < quantile(x, 0.25) - (1.5 * IQR(x)) | x > quantile(x, 0.75) + 1.5 * IQR(x))
}
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
, nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -12),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1)), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Natalidad), Natalidad, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TasaParo), TasaParo, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(IPC), IPC, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Natalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
dat.2 %>% ggplot(aes(x = cluster, y = TasaParo, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
provincias %>% ggplot(aes(x = cluster, y = TasaActividad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
provincias %>% ggplot(aes(x = cluster, y = Mortalidad, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
dat.3 %>% ggplot(aes(x = cluster, y = IPC, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5), nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Poblacion), Poblacion, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(NumEmpresas), NumEmpresas, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TVF), TVF, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Poblacion, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
dat.2 %>% ggplot(aes(x = cluster, y = NumEmpresas, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
dat.3 %>% ggplot(aes(x = cluster, y = TVF, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
provincias %>% ggplot(aes(x = cluster, y = VS, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
nrow = 2, ncol = 3, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Poblacion), Poblacion, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(NumEmpresas), NumEmpresas, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TVF), TVF, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Poblacion, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
dat.2 %>% ggplot(aes(x = cluster, y = NumEmpresas, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
dat.3 %>% ggplot(aes(x = cluster, y = TVF, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
provincias %>% ggplot(aes(x = cluster, y = VS, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
ncol = 4, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Poblacion), Poblacion, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(NumEmpresas), NumEmpresas, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TVF), TVF, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Poblacion, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5, size = 10),
dat.2 %>% ggplot(aes(x = cluster, y = NumEmpresas, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
dat.3 %>% ggplot(aes(x = cluster, y = TVF, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
provincias %>% ggplot(aes(x = cluster, y = VS, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
ncol = 4, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(Poblacion), Poblacion, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.2 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(NumEmpresas), NumEmpresas, as.numeric(NA)))
dat.2$outlier[which(is.na(dat.2$is_outlier))] <- as.numeric(NA)
dat.3 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(TVF), TVF, as.numeric(NA)))
dat.3$outlier[which(is.na(dat.3$is_outlier))] <- as.numeric(NA)
ggarrange(dat.1 %>% ggplot(aes(x = cluster, y = Poblacion, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5, size = 3),
dat.2 %>% ggplot(aes(x = cluster, y = NumEmpresas, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
dat.3 %>% ggplot(aes(x = cluster, y = TVF, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5),
provincias %>% ggplot(aes(x = cluster, y = VS, fill = cluster, label = rownames(provincias))) + geom_boxplot(),
ncol = 4, common.legend = TRUE)
rm(dat.1); rm(dat.2); rm(dat.3)
sil.
sil.k
sil <- silhouette(km.res$cluster, dist(provincias_ST))
rownames(sil) <- rownames(provincias)
sil
sil[sil[, 1] == 2,]
sil[sil[, 1] == 1,]
sil[sil[, 1] == 1,3] > 1
sil[sil[, 1] == 1,3] > 0.1
sil[sil[, 1] == 1,3] >= 0.1
dat.1 <- provincias %>% tibble::rownames_to_column(var="outlier") %>% group_by(cluster) %>% mutate(is_outlier=ifelse(is_outlier(CANE), CANE, as.numeric(NA)))
dat.1$outlier[which(is.na(dat.1$is_outlier))] <- as.numeric(NA)
dat.1 %>% ggplot(aes(x = cluster, y = CANE, fill = cluster, label = rownames(provincias))) + geom_boxplot() + geom_text(aes(label=outlier),na.rm=TRUE,position = position_dodge(width = 1), vjust = -0.5, size = 3)
rm(dat.1);
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", lwd = 2)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", font = 2)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", font.main = 2)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", font = 2)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", font.axis = 2)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", labelsize = 3, addEllipses = T, ellipse.type = "convex")
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", ggtheme = theme_minimal())
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", centroids = FALSE)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", show.clust.cent = FALSE)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", face = "bold")
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", mean.point = FALSE)
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", mean.point = FALSE, palette = "jco")
fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", mean.point = FALSE, palette = "npg")
fviz_cluster(list(data = provincias_ST, cluster = grupos.provincias),
ellipse.type = "convex", repel = TRUE, show.clust.cent = FALSE, ggtheme = theme_minimal())
grupos.provincias
plt <- fviz_pca_biplot(analisis.comp, habillage = provincias$cluster, repel = TRUE, col.var = "#2E9FDF", col.ind = "#696969", labelsize = 3, addEllipses = T, ellipse.type = "convex", mean.point = FALSE, palette = "npg")
ggplot(plt$data,aes(x=x,y=y,shape=cluster)) +
geom_point() + scale_x_reverse() + theme_bw() +
geom_text_repel(aes(label=name)) +
stat_ellipse(level=0.7)
ggplot(plt$data,aes(x=x,y=y,shape=cluster)) +
geom_point() + scale_x_reverse() + theme_bw() +
stat_ellipse(level=0.7)
ggplot(plt$data,aes(x=x,y=y)) +
geom_point() + scale_x_reverse() + theme_bw() +
stat_ellipse(level=0.7)
plt
plt + scale_y_reverse()
plt <- fviz_cluster(list(data = provincias_ST, cluster = grupos.provincias),
ellipse.type = "convex", repel = TRUE, show.clust.cent = FALSE, ggtheme = theme_minimal())
plt + scale_y_reverse()
plt
grupos.provincias
sil[sil[, 1] == 1,3] > 0.1
sil[sil[, 1] == 1] > 0.1
sil[sil[sil[, 1] == 1,3] > 0.1]
sil[sil[sil[, 1] == 1,3] > 0.1,]
sil[sil[, 1] == 1,3 > 0.1,]
sil[sil[, 1] == 1] > 0.1,]
sil[sil[, 1] == 1] > 0.1
sil[sil[sil[, 1] == 1] > 0.1]
wihch[sil[, 1] == 1] > 0.1
which[sil[, 1] == 1] > 0.1
which([sil[, 1] == 1] > 0.1)
which(sil[, 1] == 1] > 0.1)
which(sil[sil[, 1] == 1] > 0.1)
which(sil[sil[, 1] == 1, 3] > 0.1)
which(sil[sil[, 1] == 1, 3] < 0.1)
which(sil[sil[, 1] == 1, 3] < 0.11)
sil
which(sil[sil[, 1] == 1, 3] > 2)
which(sil[sil[, 1] == 1, 3] > 0.2)
which(sil[sil[, 1] == 1, 3] > 0.25)
which(sil[sil[, 1] == 2, 3] > 0.)
which(sil[sil[, 1] == 5, 3] > 0.)
which(sil[sil[, 1] == 2, 3] > 0.2)
which(sil[sil[, 1] == 2, 3] > 0.1)
which(sil[sil[, 1] == 1, 3] < 0.1)
which(sil[sil[, 1] == 1, 3] < 0.2)
sil
which(sil[sil[, 1] == 1, 3] < 0.11)
which(sil[sil[, 1] == 1, 3] < 0.2)
which(sil[sil[, 1] == 1, 3] > 0.2)
with(new,text3d(PC1,PC2,PC3,label))
knitr::kable(EsT_Clus_Comp2[c(2,5),], digits =2,caption = "Valores medios de la Componente 2")
summary(provincias)
provincias[provincias$cluster == 1, ]
sd(provincias[provincias$cluster == 1, ])
sd(provincias[provincias$cluster == 1, 1])
sd(provincias[provincias$cluster == 1, 2])
summary(provincias[provincias$cluster == 1, ])
sd(provincias[provincias$cluster == 1, ])
summary(provincias[provincias$cluster == 1, ])
summary(provincias)
x <- data.frame("c1" = c(1,2,3,4,NA,NA,NA,NA,NA))
library(scorecard)
x <- data.frame("c1" = c(1,2,3,4,NA,NA,NA,NA,NA), "y" = c(1,1,1,1,0,0,1,1,1))
var_filter(x, "y", iv_limit = 0, return_rm_reason = T)
x <- data.frame("c1" = c(1,2,NA,NA,NA,NA,NA,NA,NA), "y" = c(1,1,1,1,0,0,1,1,1))
var_filter(x, "y", iv_limit = 0, return_rm_reason = T)
data("germancredit")
dt<-germancredit
dt$y<-as.numeric(dt$creditability)
dt$y<-ifelse(dt$y==2,0,1)
dt<-dt[,-21]
dt$logamount<-log(dt$credit.amount)
dt<-dt[,-5]
# selección inicial
dt_s <- var_filter(dt,"y",iv_limit=0,return_rm_reason = TRUE)
# dividimos la serie original entre test y validación, para trabajar por separado
dt_list <- split_df(dt_s$dt, y="y", ratio = 0.7, seed = 21)
train <- dt_list$train
test <- dt_list$test
# Categorizamos
bins <- woebin(train, "y", print_step = 5)
woebin_plot(bins[[19]])
woebin_plot(bins[[12]])
## $telephone
df <- read.csv("/Users/alberto/Desktop/Finding-Exoplanet-Using-Machine-Learning-main/exoplanets_2018.csv")
View(df)
df$koi_disposition <- as.factor(df$koi_disposition)
summary(df)
9564-2367
fichero <- read.csv("~/UCM/Machine Learning Python/Practica ML/fichero.csv", row.names=1)
View(fichero)
library(scorecard)
woebin(fichero)
woebin(fichero, y = "labels")
woebin(fichero, y = "labels", positive = "True")
cut(fichero$dst_host_srv_count)
cut(fichero$dst_host_srv_count, breaks = 5)
woebin(fichero, y = "labels", positive = "True")
woebin(fichero, y = "labels", positive = "False")
library(readr)
data <- read_csv("UCM/Machine Learning Python/Practica ML/data.csv")
View(data)
library(scorecard)
woebin(data, y = "labels", positive = TRUE)
setwd("~/UCM/Machine Learning Python")
setwd("~/UCM/Machine Learning Python/Practica ML")
setwd("~/UCM/Machine Learning/Practica ML/MachineLearning")
load("~/UCM/Machine Learning/Practica ML/MachineLearning/seleccion_variables.RData")
par(cex.axis=0.5)
boxplot(data=union1,tasa~modelo,main="TASA FALLOS", col = "#F28773", lwd = 1)
par(cex.axis=0.5)
boxplot(data=union1,auc~modelo,main="AUC", col = "#F28773", lwd = 1)
medias6.df$modelo="LOGISTICA BIC SIN 3 ULTIMAS VARIABLES"
union1<-rbind(medias.base.df, medias1.df,medias2.df,medias3.df, medias4.df, medias5.df, medias6.df)
par(cex.axis=0.5)
boxplot(data=union1,tasa~modelo,main="TASA FALLOS", col = "#F28773", lwd = 1)
par(cex.axis=0.5)
boxplot(data=union1,auc~modelo,main="AUC", col = "#F28773", lwd = 1)
medias.base.df$modelo="RFE LR TOP 5"
medias1.df <- data.frame(medias1[1])
medias1.df$modelo="LOGISTICA AIC"
medias2.df$modelo="LOGISTICA BIC"
medias3.df <- data.frame(medias3[1])
medias3.df$modelo="RFE RF TOP 5"
par(cex.axis=0.5)
boxplot(data=union1,tasa~modelo,main="TASA FALLOS", col = "#F28773", lwd = 1)
par(cex.axis=0.5)
boxplot(data=union1,auc~modelo,main="AUC", col = "#F28773", lwd = 1)
union1<-rbind(medias.base.df, medias1.df,medias2.df,medias3.df, medias4.df, medias5.df, medias6.df)
par(cex.axis=0.5)
boxplot(data=union1,tasa~modelo,main="TASA FALLOS", col = "#F28773", lwd = 1)
par(cex.axis=0.5)
boxplot(data=union1,auc~modelo,main="AUC", col = "#F28773", lwd = 1)
save.image("~/UCM/Machine Learning/Practica ML/MachineLearning/seleccion_variables.RData")
load("~/UCM/Machine Learning/Practica ML/MachineLearning/redes_neuronales.RData")
union.final
rep("1", 5)
c(rep("1", 5), rep("2", 5), rep("1", 5), rep("2", 5))
union.final$formula <- c(rep("1", 5), rep("2", 5), rep("1", 5), rep("2", 5))
union.final
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", col = union.final$formula, lwd = 1)
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, boxfill = formula)
union.final$formula <- c(rep("#FFCCCB", 5), rep("#7AD7F0", 5), rep("#FFCCCB", 5), rep("#7AD7F0", 5))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, boxfill = formula)
par(cex.axis=0.5)
boxplot(data=union.final,auc~modelo,main="AUC", col = "#F28773", lwd = 1)
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, boxfill = formula, col = formula)
union.final$formula <- c(rep(rgb(0.1,0.1,0.7,0.5), 5), rep(rgb(0.8,0.1,0.3,0.6), 5),
rep(rgb(0.1,0.1,0.7,0.5), 5), rep(rgb(0.8,0.1,0.3,0.6), 5))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, boxfill = formula, col = formula)
union.final$formula <- NULL
union.final$color <- c(rep(rgb(0.1,0.1,0.7,0.5), 5), rep(rgb(0.8,0.1,0.3,0.6), 5),
rep(rgb(0.1,0.1,0.7,0.5), 5), rep(rgb(0.8,0.1,0.3,0.6), 5))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = color)
union.final
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = data$color)
union.final$color <- NULL
union.final$tipo <- c(rep(rgb(0.1,0.1,0.7,0.5), 5), rep(rgb(0.8,0.1,0.3,0.6), 5),
rep(rgb(0.1,0.1,0.7,0.5), 5), rep(rgb(0.8,0.1,0.3,0.6), 5))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = tipo)
union.final
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = c(tipo))
union.final
union.final$tipo <- NULL
union.final$formula <- c(rep("1", 5), rep("2", 5), rep("1", 5), rep("2", 5))
union.final$formula <- as.factor(union.final$formula)
union.final
colores <- ifelse(levels(union.final$formula)=="1" , rgb(0.1,0.1,0.7,0.5) ,
rgb(0.8,0.1,0.3,0.6))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomleft", legend = c("ALGORITMO 1","ALGORITMO 2l") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , pt.cex = 3, cex = 1, horiz = FALSE, inset = c(0.03, 0.1))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomleft", legend = c("ALGORITMO 1","ALGORITMO 2l") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=10 , pt.cex = 3, cex = 1, horiz = FALSE, inset = c(0.03, 0.1))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomleft", legend = c("ALGORITMO 1","ALGORITMO 2l") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1))
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomleft", legend = c("ALGORITMO 1","ALGORITMO 2l") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 1)
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomleft", legend = c("ALGORITMO 1","ALGORITMO 2l") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.5)
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomleft", legend = c("ALGORITMO 1","ALGORITMO 2l") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.75)
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottom", legend = c("ALGORITMO 1","ALGORITMO 2") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.75)
legend("bottomright", legend = c("ALGORITMO 1","ALGORITMO 2") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.75)
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomright", legend = c("ALGORITMO 1","ALGORITMO 2") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.75)
par(cex.axis=0.5)
boxplot(data=union.final,tasa~modelo,main="TASA FALLOS", lwd = 1, col = colores)
legend("bottomright", legend = c("FORMULA 1","FORMULA 2") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.75)
par(cex.axis=0.5)
boxplot(data=union.final,auc~modelo,main="AUC", col = "#F28773", lwd = 1, col = colores)
legend("bottomright", legend = c("FORMULA 1","FORMULA 2") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.75)
par(cex.axis=0.5)
boxplot(data=union.final,auc~modelo,main="AUC", col = "#F28773", lwd = 1, col = colores)
par(cex.axis=0.5)
boxplot(data=union.final,auc~modelo,main="AUC", lwd = 1, col = colores)
legend("bottomright", legend = c("FORMULA 1","FORMULA 2") ,
col = c(rgb(0.1,0.1,0.7,0.5) , rgb(0.8,0.1,0.3,0.6)) , bty = "n",
pch=20 , horiz = FALSE, inset = c(0.03, 0.1), cex = 0.75)
for(modelo in c(cvnnet.candidato.final.1, cvnnet.candidato.final.2)) {
print(modelo$table)
}
par(cex.axis=0.5)
boxplot(data=union2,tasa~modelo,main="TASA FALLOS", col = "#F28773", lwd = 1)
par(cex.axis=0.5)
boxplot(data=union2,auc~modelo,main="AUC", col = "#F28773", lwd = 1)
save.image("~/UCM/Machine Learning/Practica ML/MachineLearning/redes_neuronales.RData")
rm(list = setdiff(ls(), c("union.final")))
questionr::rename.variable(union.final, "union.final", "union.final.rrnn")
union.final <- questionr::rename.variable(union.final, "union.final", "union.final.rrnn")
union.final
load("~/UCM/Machine Learning/Practica ML/MachineLearning/redes_neuronales.RData")
rm(list = setdiff(ls(), c("union.final", "medias6.df", "medias.base.df")))
save.image("~/UCM/Machine Learning/Practica ML/MachineLearning/bagging.RData")
# BAGGING
library(randomForest)
library(parallel)
library(doParallel)
library(caret)
medias6.df$modelo <- "MODELO LOGISTICO 1"
medias.base.df$modelo <- "MODELO LOGISTICO 2"
telco.data.final <- read.csv("telco_data_final.csv", row.names = "X")
save.image("~/UCM/Machine Learning/Practica ML/MachineLearning/bagging.RData")
